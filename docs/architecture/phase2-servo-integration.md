# Phase 2: Servo ë¸Œë¼ìš°ì € í†µí•© ì•„í‚¤í…ì²˜ ì„¤ê³„

**ë²„ì „:** 1.0  
**ìƒíƒœ:** ðŸ“‹ ì„¤ê³„ ì™„ë£Œ, êµ¬í˜„ ëŒ€ê¸°  
**ìµœì¢… ìˆ˜ì •:** 2025-01-07

---

## 1. ê°œìš”

### 1.1 ëª©í‘œ

KPIO ìš´ì˜ì²´ì œì— Servo ë¸Œë¼ìš°ì € ì—”ì§„ì„ í†µí•©í•˜ì—¬ OS ìˆ˜ì¤€ì˜ ë¸Œë¼ìš°ì € ìµœì í™” ë‹¬ì„±:

| ëª©í‘œ | ê¸°ì¡´ ë¸Œë¼ìš°ì € | KPIO ëª©í‘œ | ê°œì„ ìœ¨ |
|------|--------------|-----------|--------|
| íƒ­ ì½œë“œ ìŠ¤íƒ€íŠ¸ | 2-3ì´ˆ | 0.5ì´ˆ | **4x** |
| íƒ­ë‹¹ ë©”ëª¨ë¦¬ | 100-300MB | 30-80MB | **3x** |
| GPU ë ˆì´í„´ì‹œ | 8-16ms | 2-4ms | **4x** |

### 1.2 ì•„í‚¤í…ì²˜ ê²°ì • ìš”ì•½

| ê²°ì • ì‚¬í•­ | ì„ íƒ | ì´ìœ  |
|----------|------|------|
| ë¸Œë¼ìš°ì € ì—”ì§„ | Servo (ì „ì²´) | Firefox ê²€ì¦, Rust ê¸°ë°˜ |
| ì‹¤í–‰ í™˜ê²½ | **Userspace Process** | ServoëŠ” std í•„ìˆ˜ |
| IPC ë°©ì‹ | Shared Memory + Channels | Zero-copy ì„±ëŠ¥ |
| GPU API | Vulkan (ì „ìš©) | í˜„ëŒ€ì , ì €ìˆ˜ì¤€ ì œì–´ |
| JS ì—”ì§„ | SpiderMonkey (Servo í¬í•¨) | ì™„ì „í•œ ì›¹ í˜¸í™˜ì„± |

---

## 2. í•µì‹¬ ë°œê²¬ ì‚¬í•­ (Servo ì¡°ì‚¬ ê²°ê³¼)

### 2.1 ServoëŠ” no_std ë¶ˆê°€ëŠ¥

Servo ë° ì£¼ìš” ì»´í¬ë„ŒíŠ¸ëŠ” `std` ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ê°•í•˜ê²Œ ì˜ì¡´:

```rust
// html5ever ë‚´ë¶€ - std ì˜ì¡´ì„±
use std::io::{self, Read};
use std::fs::File;
use std::collections::HashMap;

// Servo ìžì²´
use tokio::runtime::Runtime;     // async ëŸ°íƒ€ìž„
use hyper::Client;               // HTTP í´ë¼ì´ì–¸íŠ¸
use url::Url;                    // URL íŒŒì‹±
```

**ê²°ë¡ :** ServoëŠ” ë°˜ë“œì‹œ **Userspace Process**ì—ì„œ ì‹¤í–‰í•´ì•¼ í•¨

### 2.2 Servo ì»´í¬ë„ŒíŠ¸ ì˜ì¡´ì„± ë§µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Servo                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ components/servo (ë©”ì¸ ì—”íŠ¸ë¦¬)                               â”‚â”‚
â”‚  â”‚  â”œâ”€ ServoBuilder, Servo, WebView, WebViewDelegate           â”‚â”‚
â”‚  â”‚  â”œâ”€ constellation (íƒ­/í”„ë ˆìž„ ê´€ë¦¬)                          â”‚â”‚
â”‚  â”‚  â””â”€ embedder_traits (ìž„ë² ë” ì¸í„°íŽ˜ì´ìŠ¤)                     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                              â”‚                                   â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚          â–¼                  â–¼                  â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ html5ever     â”‚  â”‚ stylo         â”‚  â”‚ webrender     â”‚       â”‚
â”‚  â”‚ (HTML íŒŒì‹±)   â”‚  â”‚ (CSS ì—”ì§„)    â”‚  â”‚ (GPU ë Œë”ë§) â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚          â”‚                  â”‚                  â”‚                â”‚
â”‚          â–¼                  â–¼                  â–¼                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ markup5ever   â”‚  â”‚ rayon         â”‚  â”‚ gfx-rs/wgpu   â”‚       â”‚
â”‚  â”‚ tendril       â”‚  â”‚ (ë³‘ë ¬í™”)      â”‚  â”‚ surfman       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚
â”‚                     â”‚ SpiderMonkey  â”‚                           â”‚
â”‚                     â”‚ (JavaScript)  â”‚                           â”‚
â”‚                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â”‚ IPC (Shared Memory)
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      KPIO Kernel                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ GPU         â”‚ â”‚ Memory      â”‚ â”‚ Network     â”‚ â”‚ VirtIO    â”‚ â”‚
â”‚  â”‚ Scheduler   â”‚ â”‚ Manager     â”‚ â”‚ Stack       â”‚ â”‚ Block     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ wasmi       â”‚ â”‚ IPC         â”‚ â”‚ Process Manager             â”‚â”‚
â”‚  â”‚ (ì»¤ë„ WASM) â”‚ â”‚ Subsystem   â”‚ â”‚ (Servo í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬)       â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 Servo ìž„ë² ë”© API

ServoëŠ” ê¹”ë”í•œ ìž„ë² ë”© API ì œê³µ:

```rust
// Servo ì´ˆê¸°í™” (winit_minimal.rs ì˜ˆì œ ê¸°ë°˜)
let servo = ServoBuilder::default()
    .opts(opts)
    .preferences(preferences)
    .event_loop_waker(Box::new(waker))
    .build();

// WebView ìƒì„±
let webview = WebViewBuilder::new(&servo, rendering_context.clone())
    .delegate(delegate)
    .url(url)
    .hidpi_scale_factor(Scale::new(1.0))
    .build();

// ì´ë²¤íŠ¸ ë£¨í”„ íšŒì „
servo.spin_event_loop(/* should block */ false);
webview.paint();
```

---

## 3. ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### 3.1 í”„ë¡œì„¸ìŠ¤ ëª¨ë¸

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        KPIO System                                â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                    User Space (Ring 3)                       â”‚ â”‚
â”‚  â”‚                                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚              servo_browser Process                    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Main Thread â”‚  â”‚ Compositor  â”‚  â”‚ Layout      â”‚   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ (UI + IPC)  â”‚  â”‚ Thread      â”‚  â”‚ Workers     â”‚   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚ â”‚
â”‚  â”‚  â”‚                                                       â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚            Per-Tab Sandboxed Processes          â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Tab 1   â”‚  â”‚ Tab 2   â”‚  â”‚ Tab 3   â”‚         â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Script  â”‚  â”‚ Script  â”‚  â”‚ Script  â”‚         â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â”‚                          â”‚                                   â”‚ â”‚
â”‚  â”‚                     IPC Channels                             â”‚ â”‚
â”‚  â”‚                          â”‚                                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                   Kernel Space (Ring 0)                       â”‚ â”‚
â”‚  â”‚                          â”‚                                    â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚              Browser Support Layer                       â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ GPU       â”‚ â”‚ Tab Memoryâ”‚ â”‚ WASM AOT  â”‚ â”‚ Zero-Copyâ”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â”‚ Scheduler â”‚ â”‚ Manager   â”‚ â”‚ Cache     â”‚ â”‚ Network  â”‚ â”‚ â”‚ â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â”‚                                                               â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚                   Core Kernel                            â”‚ â”‚ â”‚
â”‚  â”‚  â”‚   Memory | Scheduler | VirtIO | PCI | APIC | wasmi      â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 IPC ì„¤ê³„: Kernel â†” Browser

```rust
// kernel/src/ipc/browser_channel.rs

/// ì»¤ë„â†’ë¸Œë¼ìš°ì € ëª…ë ¹
#[repr(C)]
pub enum KernelToBrowser {
    /// íƒ­ ë©”ëª¨ë¦¬ ì••ë ¥ ì•Œë¦¼
    MemoryPressure { 
        level: MemoryPressureLevel,
        suggested_target_mb: u32,
    },
    
    /// GPU ìš°ì„ ìˆœìœ„ ë³€ê²½
    GpuPriorityChanged {
        tab_id: u32,
        new_priority: GpuPriority,
    },
    
    /// ë„¤íŠ¸ì›Œí¬ ë°ì´í„° ë„ì°© (Zero-copy)
    NetworkDataReady {
        request_id: u64,
        shared_buffer_offset: u64,
        length: u64,
    },
    
    /// WASM AOT ìºì‹œ ížˆíŠ¸
    WasmCacheHit {
        module_hash: [u8; 32],
        cached_code_offset: u64,
    },
}

/// ë¸Œë¼ìš°ì €â†’ì»¤ë„ ìš”ì²­
#[repr(C)]
pub enum BrowserToKernel {
    /// íƒ­ ìƒíƒœ ë³€ê²½ ì•Œë¦¼
    TabStateChanged {
        tab_id: u32,
        state: TabState,
    },
    
    /// GPU ìž‘ì—… ì œì¶œ
    SubmitGpuWork {
        tab_id: u32,
        command_buffer_offset: u64,
        length: u64,
    },
    
    /// ë„¤íŠ¸ì›Œí¬ ìš”ì²­
    NetworkRequest {
        request_id: u64,
        url_offset: u64,
        url_length: u32,
    },
    
    /// WASM ëª¨ë“ˆ AOT ì»´íŒŒì¼ ìš”ì²­
    WasmCompileRequest {
        module_hash: [u8; 32],
        wasm_offset: u64,
        wasm_length: u64,
    },
}

/// íƒ­ ìƒíƒœ
#[repr(C)]
pub enum TabState {
    Foreground,          // í™œì„± íƒ­
    Background,          // ë°±ê·¸ë¼ìš´ë“œ
    BackgroundPlaying,   // ë°±ê·¸ë¼ìš´ë“œ + ë¯¸ë””ì–´ ìž¬ìƒ
    Hibernated,          // íœ´ë©´ (ë©”ëª¨ë¦¬ í•´ì œë¨)
}
```

### 3.3 ê³µìœ  ë©”ëª¨ë¦¬ ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Shared Memory Region                          â”‚
â”‚                        (16 MB)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Offset 0x0000000 - 0x0001000: Control Block (4 KB)              â”‚
â”‚   â”œâ”€ kernel_to_browser_head: AtomicU32                          â”‚
â”‚   â”œâ”€ kernel_to_browser_tail: AtomicU32                          â”‚
â”‚   â”œâ”€ browser_to_kernel_head: AtomicU32                          â”‚
â”‚   â”œâ”€ browser_to_kernel_tail: AtomicU32                          â”‚
â”‚   â””â”€ flags: AtomicU32                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Offset 0x0001000 - 0x0101000: Kâ†’B Ring Buffer (1 MB)           â”‚
â”‚   â””â”€ KernelToBrowser messages                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Offset 0x0101000 - 0x0201000: Bâ†’K Ring Buffer (1 MB)           â”‚
â”‚   â””â”€ BrowserToKernel messages                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Offset 0x0201000 - 0x0401000: Network Buffers (2 MB)           â”‚
â”‚   â””â”€ Zero-copy network data                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Offset 0x0401000 - 0x0801000: GPU Command Buffers (4 MB)       â”‚
â”‚   â””â”€ Vulkan secondary command buffers                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Offset 0x0801000 - 0x1000000: WASM Module Cache (8 MB)         â”‚
â”‚   â””â”€ AOT compiled WASM modules                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. êµ¬í˜„ ìˆœì„œ (ì˜ì¡´ì„± ê¸°ë°˜)

### Phase 2.1: ê¸°ë°˜ ì¸í”„ë¼ (4ì£¼)

```
Week 1-2: Userspace í™˜ê²½
â”œâ”€â”€ [ ] ELF ë¡œë” êµ¬í˜„
â”œâ”€â”€ [ ] ì‹œìŠ¤í…œ ì½œ ì¸í„°íŽ˜ì´ìŠ¤
â”œâ”€â”€ [ ] ì‚¬ìš©ìž ê³µê°„ ë©”ëª¨ë¦¬ ë§µí•‘
â””â”€â”€ [ ] ê¸°ë³¸ í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬

Week 3-4: IPC ì‹œìŠ¤í…œ
â”œâ”€â”€ [ ] ê³µìœ  ë©”ëª¨ë¦¬ ë§¤í•‘
â”œâ”€â”€ [ ] Ring Buffer IPC
â”œâ”€â”€ [ ] Capability ì‹œìŠ¤í…œ
â””â”€â”€ [ ] ë¸Œë¼ìš°ì €-ì»¤ë„ ì±„ë„
```

### Phase 2.2: Servo í¬íŒ… (8ì£¼)

```
Week 5-8: ìµœì†Œ Servo ë¹Œë“œ
â”œâ”€â”€ [ ] Servo í¬ë¡œìŠ¤ ì»´íŒŒì¼ í™˜ê²½ (x86_64-unknown-kpio)
â”œâ”€â”€ [ ] libc ëŒ€ì²´ êµ¬í˜„ (KPIO syscalls)
â”œâ”€â”€ [ ] ê¸°ë³¸ std ê¸°ëŠ¥ êµ¬í˜„
â”‚     â”œâ”€â”€ [ ] ë©”ëª¨ë¦¬ í• ë‹¹ (dlmalloc â†’ KPIO heap syscall)
â”‚     â”œâ”€â”€ [ ] ìŠ¤ë ˆë”© (pthread â†’ KPIO thread syscall)
â”‚     â”œâ”€â”€ [ ] íŒŒì¼ I/O (fd â†’ KPIO file syscall)
â”‚     â””â”€â”€ [ ] ë„¤íŠ¸ì›Œí¬ (socket â†’ KPIO net syscall)
â””â”€â”€ [ ] Servo ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸

Week 9-12: ë Œë”ë§ íŒŒì´í”„ë¼ì¸
â”œâ”€â”€ [ ] Vulkan ë“œë¼ì´ë²„ (Userspace ë¶€ë¶„)
â”œâ”€â”€ [ ] surfman í¬íŒ… (Vulkan ë°±ì—”ë“œ)
â”œâ”€â”€ [ ] WebRender í†µí•©
â””â”€â”€ [ ] ê¸°ë³¸ íŽ˜ì´ì§€ ë Œë”ë§ í…ŒìŠ¤íŠ¸
```

### Phase 2.3: OS í†µí•© ìµœì í™” (8ì£¼)

```
Week 13-16: GPU ìŠ¤ì¼€ì¤„ëŸ¬
â”œâ”€â”€ [ ] íƒ­ë³„ GPU ìš°ì„ ìˆœìœ„ í
â”œâ”€â”€ [ ] í¬ê·¸ë¼ìš´ë“œ íƒ­ ë¶€ìŠ¤íŒ…
â”œâ”€â”€ [ ] ë°±ê·¸ë¼ìš´ë“œ íƒ­ ìŠ¤ë¡œí‹€ë§
â””â”€â”€ [ ] VSync ë™ê¸°í™”

Week 17-20: ë©”ëª¨ë¦¬ ìµœì í™”
â”œâ”€â”€ [ ] íƒ­ë³„ ë©”ëª¨ë¦¬ ì¶”ì 
â”œâ”€â”€ [ ] ë°±ê·¸ë¼ìš´ë“œ íƒ­ ì••ì¶•
â”œâ”€â”€ [ ] íœ´ë©´ íƒ­ ë””ìŠ¤í¬ ìŠ¤ì™‘
â””â”€â”€ [ ] WASM AOT ìºì‹œ ì‹œìŠ¤í…œ
```

---

## 5. í¬ë¡œìŠ¤ ì»´íŒŒì¼ íƒ€ê²Ÿ ì„¤ì •

### 5.1 ìƒˆ íƒ€ê²Ÿ ì •ì˜: x86_64-unknown-kpio

```json
// x86_64-unknown-kpio.json
{
    "llvm-target": "x86_64-unknown-none",
    "data-layout": "e-m:e-p270:32:32-p271:32:32-p272:64:64-i64:64-i128:128-f80:128-n8:16:32:64-S128",
    "arch": "x86_64",
    "target-endian": "little",
    "target-pointer-width": "64",
    "target-c-int-width": "32",
    "os": "kpio",
    "executables": true,
    "linker-flavor": "ld.lld",
    "linker": "rust-lld",
    "panic-strategy": "abort",
    "disable-redzone": false,
    "features": "+sse,+sse2,+sse3,+sse4.1,+sse4.2,+avx",
    "dynamic-linking": false,
    "position-independent-executables": true,
    "relro-level": "full",
    "has-thread-local": true,
    "crt-static-default": true,
    "crt-static-allows-dylibs": false,
    "static-position-independent-executables": true
}
```

### 5.2 std ë¼ì´ë¸ŒëŸ¬ë¦¬ í¬íŒ… ì „ëžµ

```rust
// userspace/libkpio/src/sys/kpio/mod.rs

//! KPIO ì‹œìŠ¤í…œ ì½œ ëž˜í¼ - Rust stdë¥¼ ìœ„í•œ í”Œëž«í¼ ë ˆì´ì–´

/// ë©”ëª¨ë¦¬ í• ë‹¹
pub unsafe fn alloc(size: usize, align: usize) -> *mut u8 {
    syscall2(SYS_ALLOC, size, align) as *mut u8
}

/// ìŠ¤ë ˆë“œ ìƒì„±
pub fn spawn_thread(entry: fn(), stack_size: usize) -> Result<ThreadId, Error> {
    let tid = unsafe { syscall2(SYS_THREAD_CREATE, entry as usize, stack_size) };
    if tid < 0 {
        Err(Error::from_syscall(tid))
    } else {
        Ok(ThreadId(tid as u64))
    }
}

/// íŒŒì¼ ì—´ê¸°
pub fn open(path: &str, flags: OpenFlags) -> Result<Fd, Error> {
    let fd = unsafe { 
        syscall3(SYS_OPEN, path.as_ptr() as usize, path.len(), flags.bits() as usize) 
    };
    if fd < 0 {
        Err(Error::from_syscall(fd))
    } else {
        Ok(Fd(fd as u32))
    }
}
```

---

## 6. ìœ„í—˜ ìš”ì†Œ ë° ì™„í™” ì „ëžµ

### 6.1 ìœ„í—˜ ëª©ë¡

| ìœ„í—˜ | ì˜í–¥ë„ | í™•ë¥  | ì™„í™” ì „ëžµ |
|------|--------|------|----------|
| Servo ë¹Œë“œ ë³µìž¡ì„± | ë†’ìŒ | ë†’ìŒ | ì ì§„ì  ì ‘ê·¼, ìµœì†Œ ê¸°ëŠ¥ë¶€í„° |
| SpiderMonkey JIT | ë†’ìŒ | ì¤‘ê°„ | ì¸í„°í”„ë¦¬í„° ëª¨ë“œ fallback |
| Vulkan ë“œë¼ì´ë²„ ë²„ê·¸ | ì¤‘ê°„ | ì¤‘ê°„ | VirtIO-GPU ë¨¼ì €, ì‹¤ì œ GPU ë‚˜ì¤‘ |
| ì„±ëŠ¥ ëª©í‘œ ë¯¸ë‹¬ | ì¤‘ê°„ | ë‚®ìŒ | í”„ë¡œíŒŒì¼ë§ ê¸°ë°˜ ìµœì í™” |

### 6.2 Fallback ê³„íš

ë§Œì•½ Servo ì „ì²´ í†µí•©ì´ ì‹¤íŒ¨í•  ê²½ìš°:

1. **Option A: html5ever + CSS inline styles only**
   - HTML íŒŒì‹±ë§Œ ì‚¬ìš©
   - CSSëŠ” ê°„ë‹¨í•œ ì¸ë¼ì¸ ìŠ¤íƒ€ì¼ë§Œ
   - JavaScript ì—†ìŒ
   - ê¸°ë³¸ ë¬¸ì„œ ë·°ì–´ ìˆ˜ì¤€

2. **Option B: WebView via IPC to host browser**
   - í˜¸ìŠ¤íŠ¸ OS ë¸Œë¼ìš°ì €ì— ë Œë”ë§ ìœ„ìž„
   - KPIOëŠ” ë„¤íŠ¸ì›Œí¬/ìºì‹œë§Œ ìµœì í™”
   - ê°€ìƒí™” í™˜ê²½ì—ì„œë§Œ ë™ìž‘

---

## 7. ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ê³„íš

### 7.1 ì¸¡ì • í•­ëª©

```rust
/// ì„±ëŠ¥ ë©”íŠ¸ë¦­
pub struct BrowserMetrics {
    /// ì½œë“œ ìŠ¤íƒ€íŠ¸ ì‹œê°„ (about:blank ë¡œë“œ)
    pub cold_start_ms: u32,
    
    /// íŽ˜ì´ì§€ ë¡œë“œ ì™„ë£Œ (google.com)
    pub page_load_ms: u32,
    
    /// íƒ­ë‹¹ ê¸°ë³¸ ë©”ëª¨ë¦¬
    pub base_memory_mb: u32,
    
    /// 10íƒ­ ë©”ëª¨ë¦¬
    pub ten_tabs_memory_mb: u32,
    
    /// í”„ë ˆìž„ ë ˆì´í„´ì‹œ (60fps ëª©í‘œ)
    pub frame_latency_p99_ms: f32,
    
    /// ìž…ë ¥ ë ˆì´í„´ì‹œ
    pub input_latency_p99_ms: f32,
}

/// íƒ€ê²Ÿ ë©”íŠ¸ë¦­ (Chrome ëŒ€ë¹„)
pub const TARGET_METRICS: BrowserMetrics = BrowserMetrics {
    cold_start_ms: 500,           // Chrome ~2000
    page_load_ms: 1500,           // Chrome ~2500
    base_memory_mb: 50,           // Chrome ~150
    ten_tabs_memory_mb: 400,      // Chrome ~1500
    frame_latency_p99_ms: 4.0,    // Chrome ~16
    input_latency_p99_ms: 8.0,    // Chrome ~20
};
```

### 7.2 í…ŒìŠ¤íŠ¸ ì‚¬ì´íŠ¸

1. **about:blank** - ê¸°ë³¸ ì„±ëŠ¥
2. **google.com** - ê²€ìƒ‰
3. **wikipedia.org** - ë¬¸ì„œ
4. **youtube.com** - ë¯¸ë””ì–´
5. **github.com** - ë³µìž¡í•œ UI
6. **Speedometer 3.0** - JavaScript ë²¤ì¹˜ë§ˆí¬

---

## 8. ë‹¤ìŒ ë‹¨ê³„

### ì¦‰ì‹œ ì‹œìž‘ ê°€ëŠ¥í•œ ìž‘ì—…

1. **ELF ë¡œë” êµ¬í˜„** (ì»¤ë„)
   - Phase 2.1ì˜ ì²« ë²ˆì§¸ ìž‘ì—…
   - ì˜ì¡´ì„±: ì—†ìŒ
   
2. **ì‹œìŠ¤í…œ ì½œ í…Œì´ë¸” ì„¤ê³„** (ì»¤ë„)
   - Servo í•„ìš” syscalls ëª©ë¡í™”
   - POSIX í˜¸í™˜ ë¶€ë¶„ì§‘í•©

3. **x86_64-unknown-kpio íƒ€ê²Ÿ** (ë¹Œë“œ ì‹œìŠ¤í…œ)
   - Cargo ì„¤ì •
   - ìµœì†Œ libkpio ìŠ¤í…

### í•„ìš”í•œ ì¶”ê°€ ì—°êµ¬

1. Servo ì •í™•í•œ ì˜ì¡´ì„± ë¶„ì„ (Cargo.toml ì „ì²´)
2. SpiderMonkey ë¹Œë“œ ìš”êµ¬ì‚¬í•­
3. WebRender Vulkan ë°±ì—”ë“œ ìƒíƒœ

---

## ë¶€ë¡ A: Servo í¬ë ˆì´íŠ¸ ì˜ì¡´ì„±

```
servo (ë©”ì¸)
â”œâ”€â”€ components/servo
â”œâ”€â”€ components/constellation
â”œâ”€â”€ components/script (SpiderMonkey ë°”ì¸ë”©)
â”œâ”€â”€ components/layout (ë ˆì´ì•„ì›ƒ ì—”ì§„)
â”œâ”€â”€ components/gfx (í°íŠ¸, ì´ë¯¸ì§€)
â”œâ”€â”€ components/net (ë„¤íŠ¸ì›Œí¬)
â”œâ”€â”€ components/style (Stylo)
â”œâ”€â”€ components/webrender (WebRender í¬í•¨)
â””â”€â”€ ì™¸ë¶€ ì˜ì¡´ì„±
    â”œâ”€â”€ html5ever (HTML íŒŒì‹±)
    â”œâ”€â”€ cssparser (CSS íŒŒì‹±)
    â”œâ”€â”€ selectors (CSS ì„ íƒìž)
    â”œâ”€â”€ tokio (async ëŸ°íƒ€ìž„)
    â”œâ”€â”€ hyper (HTTP)
    â”œâ”€â”€ rustls (TLS)
    â”œâ”€â”€ image (ì´ë¯¸ì§€ ë””ì½”ë”©)
    â”œâ”€â”€ font-kit (í°íŠ¸ ë¡œë”©)
    â””â”€â”€ rayon (ë³‘ë ¬ ì²˜ë¦¬)
```

## ë¶€ë¡ B: ì°¸ê³  ìžë£Œ

- Servo ì†ŒìŠ¤: https://github.com/servo/servo
- Servo ìž„ë² ë”© ì˜ˆì œ: components/servo/examples/winit_minimal.rs
- WebRender: https://github.com/nickolasDC/nickolasDC-webrender (Firefox í†µí•©)
- html5ever: https://github.com/servo/html5ever
